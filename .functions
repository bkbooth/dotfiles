function new_project {
  if [[ -z "$1" ]]; then
    echo "
New Node.js project generator

Usage:
  new_project project-name
"
    return 1
  fi

  typeset project_name=$1

  if [[ -e $project_name ]]; then
    echo "A file or directory named '$project_name' already exists."
    return 1
  else
    echo "Creating directory '$project_name'…"
    mkdir $project_name
  fi

  # Temporarily change into new project directory
  pushd $project_name > /dev/null

  echo "Adding README.md…"
  echo "# $project_name\n\nA description of $project_name" > README.md

  echo "Adding LICENSE…"
  npx --quiet --yes license $(yarn config get init-license)

  echo "Adding CODE_OF_CONDUCT.md…"
  npx --quiet --yes covgen "$(yarn config get init-author-email)" > /dev/null

  echo "Adding .gitignore…"
  npx --quiet --yes gitignore node > /dev/null

  echo "Initializing package.json…"
  yarn init --yes --silent

  echo "Initializing git…"
  git init --quiet
  git config user.email "$(yarn config get init-author-email)"
  git add --all
  git commit --quiet --message="Initial commit"

  # Navigate back out of new project directory
  popd > /dev/null
  echo "Done! Happy hacking!"
}

function nvmuse {
  local node_version

  if [[ -n "$1" ]]; then
    # Parameter passed, use it as the version
    node_version=$1
  elif [[ -f .nvmrc ]]; then
    # No parameter, but .nvmrc exists, read from it
    node_version=$(cat .nvmrc)
  else
    # No parameter and no .nvmrc, use LTS
    node_version="--lts"
  fi

  # Check if version is already installed
  # For --lts: check if any LTS version exists
  # For specific versions: use nvm ls [version] (returns non-zero if version doesn't exist)
  if [[ "$node_version" == "--lts" ]] && nvm ls | grep -q "lts" || [[ "$node_version" != "--lts" ]] && nvm ls "$node_version" &>/dev/null; then
    nvm use "$node_version"
  else
    nvm install "$node_version"
  fi
}
